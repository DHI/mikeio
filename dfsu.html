
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Dfsu and Mesh &#8212; MIKE IO  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="EUM and items" href="eum.html" />
    <link rel="prev" title="Dfs1, Dfs2 and Dfs3" href="dfs123.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/MIKE-IO-Logo-Pos-RGB.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MIKE IO  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="getting_started.html">
   Getting started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="design.html">
   Design philosophy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dataset.html">
   Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dfs0.html">
   Dfs0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dfs123.html">
   Dfs1, Dfs2 and Dfs3
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Dfsu and Mesh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eum.html">
   EUM and items
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="generic.html">
   Generic
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/dfsu.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-flexible-mesh">
   The flexible mesh
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-dfsu-and-mesh-properties">
   Common Dfsu and Mesh properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-dfsu-and-mesh-methods">
   Common Dfsu and Mesh methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mesh-functionality">
   Mesh functionality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-functionality">
   Dfsu functionality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-types">
   Dfsu types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#layered-dfsu-files">
   Layered dfsu files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-api">
   Dfsu API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mesh-api">
   Mesh API
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Dfsu and Mesh</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-flexible-mesh">
   The flexible mesh
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-dfsu-and-mesh-properties">
   Common Dfsu and Mesh properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-dfsu-and-mesh-methods">
   Common Dfsu and Mesh methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mesh-functionality">
   Mesh functionality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-functionality">
   Dfsu functionality
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-types">
   Dfsu types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#layered-dfsu-files">
   Layered dfsu files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dfsu-api">
   Dfsu API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mesh-api">
   Mesh API
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="dfsu-and-mesh">
<span id="dfsu"></span><h1>Dfsu and Mesh<a class="headerlink" href="#dfsu-and-mesh" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TODO Not updated to MIKE IO 1.0</p>
</div>
<p>Dfsu and mesh files are both flexible mesh file formats used by MIKE 21/3 engines.
The .mesh file is an ASCII format for storing the flexible mesh geometry.
The .dfsu file is a binary dfs file with data on this mesh. The mesh geometry is
available in a .dfsu file as static items.</p>
<p>For a detailed description of the .mesh and .dfsu file specification see the <a class="reference external" href="https://manuals.mikepoweredbydhi.help/2021/General/FM_FileSpecification.pdf">flexible file format documentation</a>.</p>
<section id="the-flexible-mesh">
<h2>The flexible mesh<a class="headerlink" href="#the-flexible-mesh" title="Permalink to this headline">#</a></h2>
<p>The mesh geometry in a .mesh or a .dfsu file consists of a number of nodes and a number of elements.</p>
<p>Each node has:</p>
<ul class="simple">
<li><p>Node id</p></li>
<li><p>X,Y,Z coordinate</p></li>
<li><p>Code for the boundary</p></li>
</ul>
<p>Each element has:</p>
<ul class="simple">
<li><p>Element id</p></li>
<li><p>Element type; triangular, quadrilateral, prism etc.</p></li>
<li><p>Element table; specifies for each element the nodes that defines the element.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In MIKE Zero, node ids, element ids and layer ids are 1-based.
In MIKE IO, all ids are <strong>0-based</strong> following standard Python indexing.
That means, as an example, that when finding the element closest to a
point its id will be 1 lower in MIKE IO compared to examining the file in MIKE Zero.</p>
</div>
</section>
<section id="common-dfsu-and-mesh-properties">
<h2>Common Dfsu and Mesh properties<a class="headerlink" href="#common-dfsu-and-mesh-properties" title="Permalink to this headline">#</a></h2>
<p>MIKE IO has a <a class="reference external" href="#mikeio.Dfsu">Dfsu class</a> for handling .dfsu files
and a <a class="reference external" href="#mikeio.Mesh">Mesh class</a> for handling .mesh files both they inherit from the
same base class and have the same core functionality.</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.n_nodes" title="mikeio.Mesh.n_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.n_nodes</span></code></a></p></td>
<td><p>Number of nodes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.node_coordinates" title="mikeio.Mesh.node_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.node_coordinates</span></code></a></p></td>
<td><p>Coordinates (x,y,z) of all nodes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.codes" title="mikeio.Mesh.codes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.codes</span></code></a></p></td>
<td><p>Node codes of all nodes (0=water, 1=land, 2...=open boundaries)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.boundary_polylines" title="mikeio.Mesh.boundary_polylines"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.boundary_polylines</span></code></a></p></td>
<td><p>Lists of closed polylines defining domain outline</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.n_elements" title="mikeio.Mesh.n_elements"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.n_elements</span></code></a></p></td>
<td><p>Number of elements</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.element_coordinates" title="mikeio.Mesh.element_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.element_coordinates</span></code></a></p></td>
<td><p>Center coordinates of each element</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.element_table" title="mikeio.Mesh.element_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.element_table</span></code></a></p></td>
<td><p>Element to node connectivity</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.max_nodes_per_element" title="mikeio.Mesh.max_nodes_per_element"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.max_nodes_per_element</span></code></a></p></td>
<td><p>The maximum number of nodes for an element</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.is_tri_only" title="mikeio.Mesh.is_tri_only"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.is_tri_only</span></code></a></p></td>
<td><p>Does the mesh consist of triangles only?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.projection_string" title="mikeio.Mesh.projection_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.projection_string</span></code></a></p></td>
<td><p>The projection string</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.is_geo" title="mikeio.Mesh.is_geo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.is_geo</span></code></a></p></td>
<td><p>Are coordinates geographical (LONG/LAT)?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.is_local_coordinates" title="mikeio.Mesh.is_local_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.is_local_coordinates</span></code></a></p></td>
<td><p>Are coordinates relative (NON-UTM)?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.type_name" title="mikeio.Mesh.type_name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.type_name</span></code></a></p></td>
<td><p>Type name, e.g.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="common-dfsu-and-mesh-methods">
<h2>Common Dfsu and Mesh methods<a class="headerlink" href="#common-dfsu-and-mesh-methods" title="Permalink to this headline">#</a></h2>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.contains" title="mikeio.Mesh.contains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.contains</span></code></a></p></td>
<td><p>test if a list of points are contained by mesh</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.find_nearest_elements" title="mikeio.Mesh.find_nearest_elements"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.find_nearest_elements</span></code></a></p></td>
<td><p>Find index of nearest elements (optionally for a list)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.plot" title="mikeio.Mesh.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.plot</span></code></a></p></td>
<td><p>Plot unstructured data and/or mesh, mesh outline</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.to_shapely" title="mikeio.Mesh.to_shapely"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.to_shapely</span></code></a></p></td>
<td><p>Export mesh as shapely MultiPolygon</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.get_overset_grid" title="mikeio.Mesh.get_overset_grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.get_overset_grid</span></code></a></p></td>
<td><p>get a 2d grid that covers the domain by specifying spacing or shape</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.get_2d_interpolant" title="mikeio.Mesh.get_2d_interpolant"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.get_2d_interpolant</span></code></a></p></td>
<td><p>IDW interpolant for list of coordinates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.interp2d" title="mikeio.Mesh.interp2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.interp2d</span></code></a></p></td>
<td><p>interp spatially in data (2d only)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#mikeio.Mesh.get_element_area" title="mikeio.Mesh.get_element_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.get_element_area</span></code></a></p></td>
<td><p>Calculate the horizontal area of each element.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.elements_to_geometry" title="mikeio.Mesh.elements_to_geometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.elements_to_geometry</span></code></a></p></td>
<td><p>export a selection of elements to new flexible file geometry</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mesh-functionality">
<h2>Mesh functionality<a class="headerlink" href="#mesh-functionality" title="Permalink to this headline">#</a></h2>
<p>The Mesh class is initialized with a mesh or a dfsu file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">msh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../tests/testdata/odense_rough.mesh&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msh</span>
<span class="go">Number of elements: 654</span>
<span class="go">Number of nodes: 399</span>
<span class="go">Projection: UTM-33</span>
</pre></div>
</div>
<p>Apart from the common flexible file functionality,
the Mesh object has the following methods and properties:</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.write" title="mikeio.Mesh.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.write</span></code></a></p></td>
<td><p>write mesh to file (will overwrite if file exists)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.plot_boundary_nodes</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#mikeio.Mesh.zn" title="mikeio.Mesh.zn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mikeio.Mesh.zn</span></code></a></p></td>
<td><p>Static bathymetry values (depth) at nodes</p></td>
</tr>
</tbody>
</table>
<p>See the <a class="reference external" href="#mikeio.Mesh">Mesh API specification</a> below for a detailed description.
See the <a class="reference external" href="https://nbviewer.jupyter.org/github/DHI/mikeio/blob/main/notebooks/Mesh.ipynb">Mesh Example notebook</a> for more Mesh operations (including shapely examples).</p>
</section>
<section id="dfsu-functionality">
<h2>Dfsu functionality<a class="headerlink" href="#dfsu-functionality" title="Permalink to this headline">#</a></h2>
<p>The Dfsu class is initialized with a mesh or a dfsu file.</p>
<p>Apart from the common flexible file functionality, the Dfsu has the following <em>properties</em>:</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<p>Apart from the common flexible file functionality, the Dfsu has the following <em>methods</em>:</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<p>See the <a class="reference external" href="#mikeio.Dfsu">Dfsu API specification</a> below for a detailed description.
See the <a class="reference external" href="https://nbviewer.jupyter.org/github/DHI/mikeio/blob/main/notebooks/Dfsu%20-%20Read.ipynb">Dfsu Read Example notebook</a> for basic dfsu functionality.</p>
</section>
<section id="dfsu-types">
<h2>Dfsu types<a class="headerlink" href="#dfsu-types" title="Permalink to this headline">#</a></h2>
<p>The following dfsu file types are supported by MIKE IO.</p>
<ul class="simple">
<li><p>2D horizontal.</p></li>
<li><p>3D layered.</p></li>
<li><p>2D vertical profile - a vertical slice through a 3D layered file.</p></li>
<li><p>1D vertical column - a vertical dfs1 file and is produced by taking out one column of a 3D layered file.</p></li>
<li><p>3D/4D SW, two horizontal dimensions and 1-2 spectral dimensions. Output from MIKE 21 SW.</p></li>
</ul>
<p>The layered files (3d, 2d/1d vertical) can have both sigma- and z-layers or only sigma-layers.</p>
<p>In most cases values are stored in cell centers and vertical (z) information in nodes,
but the following values types exists:</p>
<ul class="simple">
<li><p>Standard value type, storing values on elements and/or nodes. This is the default type.</p></li>
<li><p>Face value type, storing values on element faces. This is used e.g. for HD decoupling files, to store the discharge between elements.</p></li>
<li><p>Spectral value type, for each node or element, storing vales for a number of frequencies and/or directions. This is the file type for spectral output from the MIKE 21 SW.</p></li>
</ul>
</section>
<section id="layered-dfsu-files">
<h2>Layered dfsu files<a class="headerlink" href="#layered-dfsu-files" title="Permalink to this headline">#</a></h2>
<p>There are three type of layered dfsu files: 3D dfsu, 2d vertical slices and 1d vertical profiles.</p>
<p>Apart from the basic dfsu functionality, layered dfsu have the below additional <em>properties</em>:</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<p>Apart from the basic dfsu functionality, layered dfsu have the below additional <em>methods</em>:</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In MIKE Zero, layer ids are 1-based.
In MIKE IO, all ids are <strong>0-based</strong> following standard Python indexing.
The bottom layer is 0.
In previous versions of MIKE IO, layer ids was 1-based!
From release 0.10 all ids are 0-based.</p>
</div>
</section>
<section id="dfsu-api">
<h2>Dfsu API<a class="headerlink" href="#dfsu-api" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mikeio.Dfsu">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mikeio.</span></span><span class="sig-name descname"><span class="pre">Dfsu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Dfsu" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="mesh-api">
<h2>Mesh API<a class="headerlink" href="#mesh-api" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mikeio.Mesh">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mikeio.</span></span><span class="sig-name descname"><span class="pre">Mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh" title="Permalink to this definition">#</a></dt>
<dd><p>The Mesh class is initialized with a mesh or a dfsu file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – dfsu or mesh filename</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">msh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="s2">&quot;../tests/testdata/odense_rough.mesh&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">msh</span>
<span class="go">Number of elements: 654</span>
<span class="go">Number of nodes: 399</span>
<span class="go">Projection: UTM-33</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.boundary_codes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary_codes</span></span><a class="headerlink" href="#mikeio.Mesh.boundary_codes" title="Permalink to this definition">#</a></dt>
<dd><p>Unique list of boundary codes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.boundary_polylines">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary_polylines</span></span><a class="headerlink" href="#mikeio.Mesh.boundary_polylines" title="Permalink to this definition">#</a></dt>
<dd><p>Lists of closed polylines defining domain outline</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.calc_element_coordinates">
<span class="sig-name descname"><span class="pre">calc_element_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.calc_element_coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the coordinates of the center of each element.</p>
<p>Only necessary for dynamic vertical coordinates,
otherwise use the property <em>element_coordinates</em> instead</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>np.array</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – element ids of selected elements</p></li>
<li><p><strong>zn</strong> (<em>np.array</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – only the z-coodinates of the nodes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>x,y,z of each element</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.codes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">codes</span></span><a class="headerlink" href="#mikeio.Mesh.codes" title="Permalink to this definition">#</a></dt>
<dd><p>Node codes of all nodes (0=water, 1=land, 2…=open boundaries)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mikeio.Mesh.contains" title="Permalink to this definition">#</a></dt>
<dd><p>test if a list of points are contained by mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>points</strong> (<em>array-like n-by-2</em>) – x,y-coordinates of n points to be tested</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True for points inside, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.element_coordinates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_coordinates</span></span><a class="headerlink" href="#mikeio.Mesh.element_coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Center coordinates of each element</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.element_table">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">element_table</span></span><a class="headerlink" href="#mikeio.Mesh.element_table" title="Permalink to this definition">#</a></dt>
<dd><p>Element to node connectivity</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.elements_to_geometry">
<span class="sig-name descname"><span class="pre">elements_to_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">mikeio.spatial.FM_geometry.GeometryFM</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">mikeio.spatial.FM_geometry.GeometryFMLayered</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#mikeio.Mesh.elements_to_geometry" title="Permalink to this definition">#</a></dt>
<dd><p>export a selection of elements to new flexible file geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elements</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of element ids</p></li>
<li><p><strong>node_layers</strong> (<em>str</em><em>, </em><em>optional</em>) – for 3d files either ‘top’, ‘bottom’ layer nodes
or ‘all’ can be selected, by default ‘all’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>which can be used for further extraction or saved to file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>UnstructuredGeometry</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.find_nearest_elements">
<span class="sig-name descname"><span class="pre">find_nearest_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nearest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_distances</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.find_nearest_elements" title="Permalink to this definition">#</a></dt>
<dd><p>Find index of nearest elements (optionally for a list)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em><em> or </em><em>array</em><em>(</em><em>float</em><em>)</em>) – X coordinate(s) (easting or longitude)</p></li>
<li><p><strong>y</strong> (<em>float</em><em> or </em><em>array</em><em>(</em><em>float</em><em>)</em>) – Y coordinate(s) (northing or latitude)</p></li>
<li><p><strong>z</strong> (<em>float</em><em> or </em><em>array</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – Z coordinate(s)  (vertical coordinate, positive upwards)
If not provided for a 3d file, the surface element is returned</p></li>
<li><p><strong>layer</strong> (<em>int</em><em>, </em><em>optional</em>) – Search in a specific layer only (3D files only)
Either z or layer (0-based) can be provided for a 3D file</p></li>
<li><p><strong>n_nearest</strong> (<em>int</em><em>, </em><em>optional</em>) – return this many (horizontally) nearest points for
each coordinate set, default=1</p></li>
<li><p><strong>return_distances</strong> (<em>bool</em><em>, </em><em>optional</em>) – should the horizontal distances to each point be returned?
default=False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – element ids of nearest element(s)</p></li>
<li><p><em>np.array, optional</em> – horizontal distances</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">n_nearest</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">return_distances</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">find_nearest_elements</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">n_nearest</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.get_2d_interpolant">
<span class="sig-name descname"><span class="pre">get_2d_interpolant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nearest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.get_2d_interpolant" title="Permalink to this definition">#</a></dt>
<dd><p>IDW interpolant for list of coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<em>array-like</em>) – x,y coordinates of new points</p></li>
<li><p><strong>n_nearest</strong> (<em>int</em><em>, </em><em>optional</em>) – number of nearest elements used for IDW, by default 5</p></li>
<li><p><strong>extrapolate</strong> (<em>bool</em><em>, </em><em>optional</em>) – allow extrapolation, by default False</p></li>
<li><p><strong>p</strong> (<em>float</em><em>, </em><em>optional</em>) – power of inverse distance weighting, default=2</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – an alternative to extrapolate=False,
only include elements within radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element ids and weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.array, np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.get_element_area">
<span class="sig-name descname"><span class="pre">get_element_area</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.get_element_area" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the horizontal area of each element.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>areas in m2</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.get_node_centered_data">
<span class="sig-name descname"><span class="pre">get_node_centered_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.get_node_centered_data" title="Permalink to this definition">#</a></dt>
<dd><p>convert cell-centered data to node-centered by pseudo-laplacian method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em><em>(</em><em>float</em><em>)</em>) – cell-centered data</p></li>
<li><p><strong>extrapolate</strong> (<em>bool</em><em>, </em><em>optional</em>) – allow the method to extrapolate, default:True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>node-centered data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.get_node_coords">
<span class="sig-name descname"><span class="pre">get_node_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.get_node_coords" title="Permalink to this definition">#</a></dt>
<dd><p>Get the coordinates of each node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>code</strong> (<em>int</em>) – Get only nodes with specific code, e.g. land == 1</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x,y,z of each node</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.get_overset_grid">
<span class="sig-name descname"><span class="pre">get_overset_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.get_overset_grid" title="Permalink to this definition">#</a></dt>
<dd><p>get a 2d grid that covers the domain by specifying spacing or shape</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em> or </em><em>(</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em>) – grid resolution in x-direction (or in x- and y-direction)</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>optional</em>) – grid resolution in y-direction</p></li>
<li><p><strong>shape</strong> (<em>(</em><em>int</em><em>, </em><em>int</em><em>)</em><em>, </em><em>optional</em>) – tuple with nx and ny describing number of points in each direction
one of them can be None, in which case the value will be inferred</p></li>
<li><p><strong>buffer</strong> (<em>float</em><em>, </em><em>optional</em>) – positive to make the area larger, default=0
can be set to a small negative value to avoid NaN
values all around the domain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>2d grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>&lt;mikeio.Grid2D&gt;</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.interp2d">
<span class="sig-name descname"><span class="pre">interp2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.interp2d" title="Permalink to this definition">#</a></dt>
<dd><p>interp spatially in data (2d only)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em><em> or </em><em>list</em><em>(</em><em>ndarray</em><em>)</em>) – dfsu data</p></li>
<li><p><strong>elem_ids</strong> (<em>ndarray</em><em>(</em><em>int</em><em>)</em>) – n sized array of 1 or more element ids used for interpolation</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – weights with same size as elem_ids used for interpolation</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional</em>) – reshape output</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spatially interped data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or list(ndarray)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">dfsu</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">get_overset_grid</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elem_ids</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">get_2d_interpolant</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">xy</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsi</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">interp2d</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">elem_ids</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_2d">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_2d</span></span><a class="headerlink" href="#mikeio.Mesh.is_2d" title="Permalink to this definition">#</a></dt>
<dd><p>Type is either mesh or Dfsu2D (2 horizontal dimensions)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_geo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_geo</span></span><a class="headerlink" href="#mikeio.Mesh.is_geo" title="Permalink to this definition">#</a></dt>
<dd><p>Are coordinates geographical (LONG/LAT)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_layered">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_layered</span></span><a class="headerlink" href="#mikeio.Mesh.is_layered" title="Permalink to this definition">#</a></dt>
<dd><p>Type is layered dfsu (3d, vertical profile or vertical column)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_local_coordinates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_local_coordinates</span></span><a class="headerlink" href="#mikeio.Mesh.is_local_coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Are coordinates relative (NON-UTM)?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_spectral">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_spectral</span></span><a class="headerlink" href="#mikeio.Mesh.is_spectral" title="Permalink to this definition">#</a></dt>
<dd><p>Type is spectral dfsu (point, line or area spectrum)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.is_tri_only">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_tri_only</span></span><a class="headerlink" href="#mikeio.Mesh.is_tri_only" title="Permalink to this definition">#</a></dt>
<dd><p>Does the mesh consist of triangles only?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.max_nodes_per_element">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_nodes_per_element</span></span><a class="headerlink" href="#mikeio.Mesh.max_nodes_per_element" title="Permalink to this definition">#</a></dt>
<dd><p>The maximum number of nodes for an element</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.n_elements">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_elements</span></span><a class="headerlink" href="#mikeio.Mesh.n_elements" title="Permalink to this definition">#</a></dt>
<dd><p>Number of elements</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.n_nodes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_nodes</span></span><a class="headerlink" href="#mikeio.Mesh.n_nodes" title="Permalink to this definition">#</a></dt>
<dd><p>Number of nodes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.node_coordinates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_coordinates</span></span><a class="headerlink" href="#mikeio.Mesh.node_coordinates" title="Permalink to this definition">#</a></dt>
<dd><p>Coordinates (x,y,z) of all nodes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'patch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_refinements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_outline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.plot" title="Permalink to this definition">#</a></dt>
<dd><p>Plot unstructured data and/or mesh, mesh outline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em> or </em><em>a Dataset with a single item</em><em>, </em><em>optional</em>) – value for each element to plot, default bathymetry</p></li>
<li><p><strong>elements</strong> (<em>list</em><em>(</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – list of element ids to be plotted</p></li>
<li><p><strong>plot_type</strong> (<em>str</em><em>, </em><em>optional</em>) – type of plot: ‘patch’ (default), ‘mesh_only’, ‘shaded’,
‘contour’, ‘contourf’ or ‘outline_only’</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – axes title</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – colorbar label (or title if contour plot)</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.cm.cmap</em><em>, </em><em>optional</em>) – colormap, default viridis</p></li>
<li><p><strong>vmin</strong> (<em>real</em><em>, </em><em>optional</em>) – lower bound of values to be shown on plot, default:None</p></li>
<li><p><strong>vmax</strong> (<em>real</em><em>, </em><em>optional</em>) – upper bound of values to be shown on plot, default:None</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>list</em><em>(</em><em>float</em><em>)</em><em>, </em><em>optional</em>) – for contour plots: how many levels, default:10
or a list of discrete levels e.g. [3.0, 4.5, 6.0]</p></li>
<li><p><strong>show_mesh</strong> (<em>bool</em><em>, </em><em>optional</em>) – should the mesh be shown on the plot? default=True</p></li>
<li><p><strong>show_outline</strong> (<em>bool</em><em>, </em><em>optional</em>) – should domain outline be shown on the plot? default=True</p></li>
<li><p><strong>n_refinements</strong> (<em>int</em><em>, </em><em>optional</em>) – for ‘shaded’ and ‘contour’ plots (and if show_mesh=False)
do this number of mesh refinements for smoother plotting</p></li>
<li><p><strong>figsize</strong> (<em>(</em><em>float</em><em>, </em><em>float</em><em>)</em><em>, </em><em>optional</em>) – specify size of figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes</em><em>, </em><em>optional</em>) – Adding to existing axis, instead of creating new fig</p></li>
<li><p><strong>add_colorbar</strong> (<em>bool</em>) – Add colorbar to plot, default True</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>&lt;matplotlib.axes&gt;</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dfs</span> <span class="o">=</span> <span class="n">Dfsu</span><span class="p">(</span><span class="s2">&quot;HD2D.dfsu&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfs</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># bathymetry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span> <span class="o">=</span> <span class="n">dfs</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="s2">&quot;Surface elevation&quot;</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 884)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds</span><span class="o">.</span><span class="n">n_items</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dfs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span> <span class="c1"># plot surface elevation</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.projection_string">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">projection_string</span></span><a class="headerlink" href="#mikeio.Mesh.projection_string" title="Permalink to this definition">#</a></dt>
<dd><p>The projection string</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.to_shapely">
<span class="sig-name descname"><span class="pre">to_shapely</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.to_shapely" title="Permalink to this definition">#</a></dt>
<dd><p>Export mesh as shapely MultiPolygon</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>polygons with mesh elements</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>shapely.geometry.MultiPolygon</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.type_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type_name</span></span><a class="headerlink" href="#mikeio.Mesh.type_name" title="Permalink to this definition">#</a></dt>
<dd><p>Type name, e.g. Mesh, Dfsu2D</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.valid_codes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">valid_codes</span></span><a class="headerlink" href="#mikeio.Mesh.valid_codes" title="Permalink to this definition">#</a></dt>
<dd><p>Unique list of node codes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mikeio.Mesh.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfilename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mikeio.Mesh.write" title="Permalink to this definition">#</a></dt>
<dd><p>write mesh to file (will overwrite if file exists)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfilename</strong> (<em>str</em>) – path to file</p></li>
<li><p><strong>elements</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – list of element ids (subset) to be saved to new mesh</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mikeio.Mesh.zn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zn</span></span><a class="headerlink" href="#mikeio.Mesh.zn" title="Permalink to this definition">#</a></dt>
<dd><p>Static bathymetry values (depth) at nodes</p>
</dd></dl>

</dd></dl>

</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="dfs123.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Dfs1, Dfs2 and Dfs3</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="eum.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">EUM and items</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Henrik Andersson, Jesper Mariegaard, Marc Ridler<br/>
  
      &copy; Copyright 2022, Henrik Andersson, Jesper Mariegaard, Marc Ridler,.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>